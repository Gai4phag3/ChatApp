const signupForm = document.getElementById('signupForm');
signupForm.addEventListener('submit', async (e) => {
  e.preventDefault();

  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value.trim();

  if (!username || !password) {
    alert('Please enter username and password');
    return;
  }

  // Check if user already exists
  const userDoc = await db.collection('users').doc(username).get();
  if (userDoc.exists) {
    alert('Username already taken');
    return;
  }

  try {
    // Save user to Firestore with empty friends array
    await db.collection('users').doc(username).set({
      username: username,
      password: password,  // Note: storing plaintext passwords is insecure, for testing only
      friends: []
    });

    // Store username locally and redirect to dashboard
    localStorage.setItem('username', username);
    window.location.href = 'dashboard.html';

  } catch (error) {
    console.error('Error signing up:', error);
    alert('Error signing up, try again');
  }
});